{% extends "base.html" %}
{% block content %}

<div class="container mt-5">
  <h2>Edit Group</h2>

  <form method="POST">
    {{ form.hidden_tag() }}

    <div class="mb-3">
      {{ form.name.label(class="form-label") }}
      {{ form.name(class="form-control") }}
    </div>

    <div class="mb-3">
      {{ form.city.label(class="form-label") }}
      {{ form.city(class="form-control") }}
    </div>

    <div class="mb-3">
      {{ form.state.label(class="form-label") }}
      {{ form.state(class="form-control") }}
    </div>

    <div class="mb-3">
      {{ form.group_details.label(class="form-label") }}
      {{ form.group_details(class="form-control", rows="3") }}
    </div>

    <div class="mb-3">
      {{ form.img_url.label(class="form-label") }}
      {{ form.img_url(class="form-control") }}
    </div>

    <div class="form-group">
      {{ form.approximate_age_range.label }}
      {{ form.approximate_age_range(class="form-control", id="age-dropdown") }}
    </div>

    <div class="form-group" id="custom-age-group" style="display: none;">
      {{ form.custom_age_range.label }}
      {{ form.custom_age_range(class="form-control") }}
    </div>

    <div class="mb-3">
      {{ form.website_address.label(class="form-label") }}
      {{ form.website_address(class="form-control") }}
    </div>

    <div class="mb-3">
      {{ form.social_media.label(class="form-label") }}
      {{ form.social_media(class="form-control") }}
    </div>

    <div class="mb-3">
      {{ form.map_url.label(class="form-label") }}
      {{ form.map_url(class="form-control") }}
    </div>

    <!-- âœ… Latitude & Longitude Fields -->
    <div class="row">
      <div class="col-md-6 mb-3">
        {{ form.lat.label(class="form-label") }}
        {{ form.lat(class="form-control") }}
      </div>
      <div class="col-md-6 mb-3">
        {{ form.lon.label(class="form-label") }} {# <-- lon, not lng #}
        {{ form.lon(class="form-control") }}
      </div>
    </div>

    <div class="mb-3">
      {{ form.most_current_event.label(class="form-label") }}
      {{ form.most_current_event(class="form-control") }}
      {% for error in form.most_current_event.errors %}
        <div class="text-danger">{{ error }}</div>
      {% endfor %}
    </div>

    <button type="submit" class="btn btn-primary">Update Group</button>
    <a href="{{ url_for('admin_dashboard') }}" class="btn btn-secondary ms-2">Cancel</a>
  </form>

  <!-- Delete button -->
  <form method="POST" action="{{ url_for('delete_group', group_id=group.id) }}" class="mt-3"
        onsubmit="return confirm('Are you sure you want to delete this group? This action cannot be undone.');">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
    <button type="submit" class="btn btn-danger">Delete Group</button>
  </form>
</div>

<script>
  const ageDropdown = document.getElementById("age-dropdown");
  const customAgeGroup = document.getElementById("custom-age-group");

  ageDropdown.addEventListener("change", function () {
    customAgeGroup.style.display = this.value === "Other" ? "block" : "none";
  });

  if (ageDropdown.value === "Other") {
    customAgeGroup.style.display = "block";
  }
</script>

{% endblock %}
